---
title: 'PWMDAC'
sidebar_position: 22
---

# PWMDAC

PWMDAC实验

## 前言

虽然STM32N647没有内部DAC，通常情况下，可以采用专用的D/A芯片来实现，但是这样就会带来成本的增加。不过STM32所有的芯片都有PWM输出，并且PWM输出通道很多，资源丰富。因此，我们可以使用PWM+简单的RC滤波来实现DAC的输出从而节省成本。

本章我们将向大家介绍如何使用STM32N647的PWM来设计一个DAC。我们将使用按键控制STM32N647的PWM输出，从而控制PWMDAC的输出电压，通过ADC1的通道15（PF6）采集PWM DAC的输出电压，并在LCD模块上面显示ADC获取到的电压值以及PWM DAC的设定输出电压值等信息

我们将设计一个8位的DAC，使用按键控制STM32N647的PWM输出（占空比），从而控制PWM DAC的输出电压。为了得知PWM的输出电压，通过ADC1的通道15（PF6）采集PWM DAC的输出电压，并在LCD模块上面显示ADC获取到的电压值以及PWM  DAC的设定输出电压值等信息。

## 实验准备

1. 编写成功后，切换BOOT1跳线帽至3.3V处，便可进行程序下载，下载完之后，将BOOT1跳线帽切换回GND处，对开发板重新上电。
1. 在开发板的右下角P14处，用跳线帽短接PDC和ADC针脚，将其连接到一起，这样ADC就能采集到PWM输出的DAC值。

## 实验现象

下载代码后，LED0不停的闪烁，提示程序已经在运行了。我们按下KEY_UP/KEY1调整PWM的占空比，可以看到输出电压随PWM VAL发生变化，也可以把PF0和PWM DAC的最终输出接到示波器观察滤波后的区别。
